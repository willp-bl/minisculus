# Introduction to Docker

## Presentation

[presentation.html](presentation.html)

## Install Things You Need

### Docker for Mac

[Docker for Mac](https://docs.docker.com/docker-for-mac/)

Note: remember to verify the checksum of the installer before using
it: `shasum -a256 -c Docker.dmg.sha256sum`

### Maven

`brew install maven`

## Dockerfile

A Dockerfile that will package up the microservice into a container is present

## Microservice

A Java/Dropwizard microservice is in `./microservice/`.  An executable
jar can be generated by running `mvn package` and the microservice can
be run with the command `java -jar ./target/microservice-1.0.jar
server config/microservice.yml`.

## Config overrides

To override a setting in the `./config/microservice.yml` config file:

* `java -Ddw.applicationConnector[0].port=8088 -jar target/microservice-1.0.jar`
* `MS_MESSAGE="some message" java -jar target/microservice-1.0.jar`

## Challenges

1. Install Docker for Mac and Maven
2. Have a look at the contents of the Dockerfile
2. Package and run the Docker container
   * `5_docker$ docker build -t microservice .` [This command builds the container using the Dockerfile in the current directory and names it microservice]
   * `5_docker$ docker run -it --rm --name microservice -p 9000:8080 microservice` [This command runs interactively, destroys the container state when finished, maps port 8080 exposed by the Dockerfile to host port 9000 and names the running container microservice]
   * `$ curl -v :9000`
   * take a look at the output of `docker ps` when the container is running
3. Modify some config externally from the container by using the `docker run` command line (hint: try changing the message returned by the microservice)
4. Modify some config externally from the container that can only be set by using parameters to the java command line (hint: use a new env var inside the container)
5. In MicroserviceApplication.initialize() make strict be true, this ensures all environment variables must be present.  Make the container run.
6. Use `docker-compose` to spin up more than one microservice.  Try and load balance using `dockercloud-haproxy` (autoreconfigures when containers added/removed) - Note: I haven't tested this.

